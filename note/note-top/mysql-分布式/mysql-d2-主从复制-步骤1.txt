
7、提升备库成为主库
有些情况需要将备库提升为主库，一种情况是计划内的，另一种是计划外的，如主库宕机。
7.1计划内的提升
	1)、停止当前主库上所有的写操作，如果可以，最好将所有的客户端程序关闭，如果正在使用虚拟IP地址，也可以简单的关闭虚拟IP，然后断开所有的客户端连接以关闭其打开的事物。
	2)、通过Flush tables with read lock; 在主库停止所有活跃的写入，这一步是可选的。这时刻应该禁止向即将被替换的主库写入，因为写入的任何数据意味着丢失。为了更好的保证这一点，可以kill所有打开的事物，这会真正的结束所有写入。
	3)、选择一个备库作为主库，并确保它执行完所有从主库获得的中继日志。
	4)、确保新主库和旧主库的数据是一致的。
	5)、新主库执行stop slave;
	6)、在新主库执行CHANGE MASTER TO MASTER_HOST='';，然后执行RESET SLAVE，使其断开与老主库的连接，并丢弃master.info 里面的信息。如果连接信息保存在my.cnf里面，会无法正确工作
	7)、执行SHOW MASTER STATUS；记录新主库的二进制日志坐标
	8)、确保其它备库已经赶上。
	9)、关闭旧主库
	10)、在MySQL 5.1 以及以上的版本，如果需要，激活新主库的事件
	11)、将客户端连接到新主库
	12)、在每台备库上面，执行CHANGE MASTER TO语句使用之前通过SHOW MASTER STATUS获得的二进制坐标日志，来指向新的主库。
7.2计划外的提升
	1)、确定那台备库的数据最新，检查每台备库上SHOW SLAVE STATUS；命令的输出，选择值最新的哪一个
	2)、让所有的被执行完所有其从崩溃前的旧主库获得的中继日志，如果再未完成前修改备库的主库，它会抛弃剩下的日志事件，从而无法获得该备库在什么地方停止。
	3)、执行计划内提升的5~7步。
	4)、比较每台备库和新主库的MASTER_LOG_FILE/Read_Master_Log_Pos的值。
	5)、执行计划内提升的的10~12步。
	
11、总结：
       1)、复制是个大的话题，建议自己多去搜集些资料以供后来参考
       2)、实际中，不要使用mysql的超级用户登录，这样在配置从服务器容易出错。使用一般的用户即可。
       3)、这篇博文还有很多未涉及到的东西，以后可能会补充。另外就是如果有错误，欢迎指出。